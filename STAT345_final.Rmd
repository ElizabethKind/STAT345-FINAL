---
title: "Group 1: Monopoly"
output: word_document
date: "2025-04-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Section One
```{r}
# Word docx in repository
```


## Section Two
```{r}
dice_1 <- function() {
  sample(1:6, 1)
}

dice_2 <- function() {
  sample(1:6, 1)
}

property_sum_10games <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list(
    player1 <- 0,
    player2 <- 0,
    player3 <- 0,
    player4 <- 0
  )

  for (i in 1:50) {
    for (j in 1:4) {
      dice_total <- dice_1() + dice_2()
      players[[j]] <- (players[[j]] + dice_total) %% 41
      game_board[players[[j]]] <- game_board[players[[j]]] + 1
    }
  }

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games <- property_sum_10games + properties
}  

names(property_sum_10games) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

library(ggplot2)

prop_freq1 <- data.frame(
  property = factor(names(property_sum_10games), levels = names(property_sum_10games)),
  frequency = property_sum_10games
)

ggplot(prop_freq1, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Section Three
```{r}
property_sum_10games_jail <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list( # Store players as a list of data frames with their information
    player1 <- data.frame(
      location = 0, # Location on the board (integer)
      double_rolls = 0, # Number of times doubles have been rolled consecutively (integer)
      jail = FALSE, # Is the player in jail? (boolean)
      jail_rolls = 0), # Number of times a player has rolled while in jail (integer)
    player2 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player3 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player4 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0)
  )

  for (i in 1:50) { # Each player has 50 turns
    for (j in 1:4) { # Players take turns in order
      if (players[[j]]$jail == TRUE) { # If the player is in jail...
        d1 = dice_1()
        d2 = dice_2()
        jail_rolls <- jail_rolls + 1
        
        if (d1 == d2 || players[[j]]$jail_rolls == 3) { # If the player rolls doubles or has been in jail for 3 turns, then they get out
          jail = FALSE
          players[[j]]$jail_rolls <- 0
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        }
        
      } else { # If the player is not in jail...
        d1 = dice_1()
        d2 = dice_2()
        dice_total <- dice_1() + dice_2()
        players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
        game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        
        if (players[[j]]$location == 31) { # Player landed on "Go to jail"
          players[[j]]$location <- 11
          jail = TRUE
        } else if (d1 == d2) { # Player rolled doubles on their first roll
          players[[j]]$double_rolls = players[[j]]$double_rolls + 1
        }
        
        while (players[[j]]$double_rolls > 0 & players[[j]]$double_rolls < 3) { # Player rolls again if they got doubles
          d1 = dice_1()
          d2 = dice_2()
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
          
          if (d1 == d2) { # Increment the player's number of consecutive doubles rolls
            players[[j]]$double_rolls = players[[j]]$double_rolls + 1
          }
        }
        
        if (players[[j]]$double_rolls == 3) { # If player rolls double 3 times in a row, then they go to jail
          players[[j]]$location <- 11
          jail = TRUE
        }
      }
    }  
  }    

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games_jail <- property_sum_10games_jail + properties
}  

names(property_sum_10games_jail) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

library(ggplot2)

prop_freq2 <- data.frame(
  property = factor(names(property_sum_10games_jail), levels = names(property_sum_10games_jail)),
  frequency = property_sum_10games_jail
)

ggplot(prop_freq2, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "pink") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies\nWith Jail and Doubles Conditions") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


## Section Four
```{r}
# Chance (Movement Cards):
  # Advance to Boardwalk
  # Advance to Go (Collect $200)
  # Advance to Illinois Avenue. If you pass Go, collect $200.
  # Advance to St. Charles Place. If you pass Go, collect $200.
  # Advance to the nearest Railroad. If unowned, you may buy it from the Bank. If owned, pay owner twice the rental to which they are otherwise entitled.
  # Advance to the nearest Railroad. If unowned, you may buy it from the Bank. If owned, pay owner twice the rental to which they are otherwise entitled.
  # Advance token to nearest Utility. If unowned, you may buy it from the Bank. If owned, throw dice and pay owner a total ten times amount thrown.
  # Go Back 3 Spaces.
  # Go to Jail. Go directly to Jail, do not pass Go, do not collect $200.
  # Take a trip to Reading Railroad. If you pass Go, collect $200.

# Chance (Non-Movement Cards):
  # Bank pays you dividend of $50.
  # Get Out of Jail Free.
  # Make general repairs on all your property. For each house pay $25. For each hotel pay $100. (doesn't apply here)
  # Speeding fine $15.
  # You have been elected Chairman of the Board. Pay each player $50.
  # Your building loan matures. Collect $150

# Chance function
chance <- function() {
  card <- sample(1:16, 1)
  if (card == 1) {
    players[[j]]$location <- 40 # Advance to Boardwalk
  } else if (card == 2) {
    players[[j]]$location <- 1 # Advance to Go
  } else if (card == 3) {
    players[[j]]$location <- 25 # Advance to Illinois Ave
  } else if (card == 4) {
    players[[j]]$location <- 12 # Advance to St. Charles Place
  } else if (card == 5 || card == 6) { # Advance to the nearest railroad
    if (players[[j]]$location == 37) {
      players[[j]]$location <- 6 # Advance to Reading Railroad
    } else if (players[[j]]$location == 8) {
      players[[j]]$location <- 16 # Advance to Pennsylvania Railroad
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 26 # Advance to B&O Railroad
    } # Short Line doesn't apply here
  } else if (card == 7) { # Advance to the nearest utility
    if (players[[j]]$location == 8 || players[[j]]$location == 37) {
      players[[j]]$location <- 13 # Advance to Electric Company
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 29 # Advance to Water Works
    }
  } else if (card == 8) {
    players[[j]]$location <- players[[j]]$location - 3 # Move backwards 3 places
  } else if (card == 9) {
    players[[j]]$location <- 11 # Go to jail
    players[[j]]$jail == TRUE
  } else if (card == 10) {
    players[[j]]$location <- 6 # Advance to Reading Railroad
  } 
 }

# Simulation with the chance function and jail conditions
property_sum_10games_chance <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list(
    player1 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player2 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player3 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player4 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0)
  )

  for (i in 1:50) {
    for (j in 1:4) {
      if (players[[j]]$jail == TRUE) {
        d1 = dice_1()
        d2 = dice_2()
        jail_rolls <- jail_rolls + 1
        
        if (d1 == d2 || players[[j]]$jail_rolls == 3) {
          jail = FALSE
          players[[j]]$jail_rolls <- 0
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        }
        
      } else {
        d1 = dice_1()
        d2 = dice_2()
        dice_total <- dice_1() + dice_2()
        players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
        if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
        game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        
        if (players[[j]]$location == 31) {
          players[[j]]$location <- 11
          jail = TRUE
        } else if (d1 == d2) {
          players[[j]]$double_rolls = players[[j]]$double_rolls + 1
        }
        
        while (players[[j]]$double_rolls > 0 & players[[j]]$double_rolls < 3) {
          d1 = dice_1()
          d2 = dice_2()
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
          
          if (d1 == d2) {
            players[[j]]$double_rolls = players[[j]]$double_rolls + 1
          }
        }
        
        if (players[[j]]$double_rolls == 3) {
          players[[j]]$location <- 11
          jail = TRUE
        }
      }
    }  
  }    

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games_chance <- property_sum_10games_chance + properties
}  

names(property_sum_10games_chance) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

# Plot
library(ggplot2)

prop_freq2 <- data.frame(
  property = factor(names(property_sum_10games_chance), levels = names(property_sum_10games_chance)),
  frequency = property_sum_10games_chance
)

ggplot(prop_freq2, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "maroon") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies\nWith Jail and Doubles Conditions") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Section Five
```{r}
# Community Chest Cards:
  # 1. Advance to Go (Collect $200)
  # 2. Bank error in your favor. Collect $200
  # 3. Doctor’s fee. Pay $50
  # 4. From sale of stock you get $50
  # 5. Get Out of Jail Free
  # 6. Go to Jail. Go directly to jail, do not pass Go, do not collect $200
  # 7. Holiday fund matures. Receive $100
  # 8. Income tax refund. Collect $20
  # 9. It is your birthday. Collect $10 from every player
  # 10. Life insurance matures. Collect $100
  # 11. Pay hospital fees of $100
  # 12. Pay school fees of $50
  # 13. Receive $25 consultancy fee
  # 14. You have won second prize in a beauty contest. Collect $10
  # 15. You inherit $100
  # 16. You are assessed for street repair. $40 per house. $115 per hotel (doesn't apply here)

# Simulation with the Chance function
chance <- function() {
  card <- sample(1:16, 1)
  old_location <- players[[j]]$location
  new_location <- players[[j]]$location
   if (card == 1) {
    players[[j]]$location <- 40 # Advance to Boardwalk
    new_location <- players[[j]]$location
  } else if (card == 2) {
    players[[j]]$location <- 1 # Advance to Go
    new_location <- players[[j]]$location
  } else if (card == 3) {
    players[[j]]$location <- 25 # Advance to Illinois Ave
    new_location <- players[[j]]$location
  } else if (card == 4) {
    players[[j]]$location <- 12 # Advance to St. Charles Place
    new_location <- players[[j]]$location
  } else if (card == 5 || card == 6) { # Advance to the nearest railroad
    if (players[[j]]$location == 37) {
      players[[j]]$location <- 6 # Advance to Reading Railroad
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 8) {
      players[[j]]$location <- 16 # Advance to Pennsylvania Railroad
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 26 # Advance to B&O Railroad
      new_location <- players[[j]]$location
    } 
  } else if (card == 7) { # Advance to the nearest utility
    if (players[[j]]$location == 8 || players[[j]]$location == 37) {
      players[[j]]$location <- 13 # Advance to Electric Company
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 29 # Advance to Water Works
      new_location <- players[[j]]$location
    }
  } else if (card == 8) {
    players[[j]]$location <- players[[j]]$location - 3 # Move backwards 3 places
    new_location <- players[[j]]$location
  } else if (card == 9) {
    players[[j]]$location <- 11 # Go to jail
    players[[j]]$jail == TRUE
    new_location <- players[[j]]$location
  } else if (card == 10) {
    players[[j]]$location <- 6 # Advance to Reading Railroad
    new_location <- players[[j]]$location
  } 

  if (new_location < old_location && card %in% c(3,4,10)) {
    players[[j]]$money <- players[[j]]$money + 200 # Passing Go for cards 3, 4, and 10
  }
  
    else if (card == 11) {
      players[[j]]$money <- players[[j]]$money + 50 # Bank pays you $50
    }
    else if (card == 12) {
      players[[j]]$get_out_of_jail_free == TRUE # Get out of jail free card
    }
    else if (card == 13) {
      players[[j]]$money <- players[[j]]$money - 15 # Speeding fine $15
      property_info$free_parking <- property_info$free_parking + 15
    }
    else if (card == 14) {
      players[[j]]$money <- players[[j]]$money - 50 * (length(players) - 1)
        for (k in 1:length(players)) {
          if (k != j) {
            players[[k]]$money <- players[[k]]$money + 50 # Elected Chairman of the Board; pay each player $50
          }
        }
    }
    else if (card == 15) {
      players[[j]]$money <- players[[j]]$money + 150 # Building loan matures; collect $150
      
      # Card 16 is paying for houses and hotels -- doesn't apply here
    }
}

# Community Chest Cards Function
chest_positions <- c(3, 18, 34)
chest <- function() {
  chest_card <- sample(1:15, 1)
  if (players[[j]]$location %in% chest_positions) {
    if (chest_card == 1) {
      players[[j]]$location <- 1
      players[[j]]$money <- players[[j]]$money + 200
    } else if (chest_card == 2) {
      players[[j]]$money <- players[[j]]$money + 200
    } else if (chest_card == 3) {
      players[[j]]$money <- players[[j]]$money - 50
    } else if (chest_card == 4) {
      players[[j]]$money <- players[[j]]$money + 50
    } else if (chest_card == 5) {
      players[[j]]$get_out_of_jail_free == TRUE
    } else if (chest_card == 6) {
      players[[j]]$jail == TRUE
    } else if (chest_card == 7) {
      players[[j]]$money <- players[[j]]$money + 100
    } else if (chest_card == 8) {
      players[[j]]$money <- players[[j]]$money + 20
    } else if (chest_card == 9) {
      players[[j]]$money <- players[[j]]$money + 10 * (length(players) - 1)
        for (k in 1:length(players)) {
          if (k != j) {
            players[[k]]$money <- players[[k]]$money - 10
    } else if (chest_card == 10) {
      players[[j]]$money <- players[[j]]$money + 100
    } else if (chest_card == 11) {
      players[[j]]$money <- players[[j]]$money - 100
    } else if (chest_card == 12) {
      players[[j]]$money <- players[[j]]$money - 50
    } else if (chest_card == 13) {
      players[[j]]$money <- players[[j]]$money - 25 
    } else if (chest_card == 14) {
      players[[j]]$money <- players[[j]]$money + 10
    } else if (chest_card == 15) {
      players[[j]]$money <- players[[j]]$money + 100
    }
  }
}
```



