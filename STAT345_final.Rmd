---
title: "Group 1: Monopoly"
output: word_document
date: "2025-04-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Section One
```{r}
# Word docx in repository
```


## Section Two
```{r}
dice_1 <- function() {
  sample(1:6, 1)
}

dice_2 <- function() {
  sample(1:6, 1)
}

property_sum_10games <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list(
    player1 <- 0,
    player2 <- 0,
    player3 <- 0,
    player4 <- 0
  )

  for (i in 1:50) {
    for (j in 1:4) {
      dice_total <- dice_1() + dice_2()
      players[[j]] <- (players[[j]] + dice_total) %% 41
      game_board[players[[j]]] <- game_board[players[[j]]] + 1
    }
  }

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games <- property_sum_10games + properties
}  

names(property_sum_10games) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

library(ggplot2)

prop_freq1 <- data.frame(
  property = factor(names(property_sum_10games), levels = names(property_sum_10games)),
  frequency = property_sum_10games
)

ggplot(prop_freq1, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Section Three
```{r}
property_sum_10games_jail <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list( # Store players as a list of data frames with their information
    player1 <- data.frame(
      location = 0, # Location on the board (integer)
      double_rolls = 0, # Number of times doubles have been rolled consecutively (integer)
      jail = FALSE, # Is the player in jail? (boolean)
      jail_rolls = 0), # Number of times a player has rolled while in jail (integer)
    player2 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player3 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player4 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0)
  )

  for (i in 1:50) { # Each player has 50 turns
    for (j in 1:4) { # Players take turns in order
      if (players[[j]]$jail == TRUE) { # If the player is in jail...
        d1 = dice_1()
        d2 = dice_2()
        jail_rolls <- jail_rolls + 1
        
        if (d1 == d2 || players[[j]]$jail_rolls == 3) { # If the player rolls doubles or has been in jail for 3 turns, then they get out
          jail = FALSE
          players[[j]]$jail_rolls <- 0
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        }
        
      } else { # If the player is not in jail...
        d1 = dice_1()
        d2 = dice_2()
        dice_total <- dice_1() + dice_2()
        players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
        game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        
        if (players[[j]]$location == 31) { # Player landed on "Go to jail"
          players[[j]]$location <- 11
          jail = TRUE
        } else if (d1 == d2) { # Player rolled doubles on their first roll
          players[[j]]$double_rolls = players[[j]]$double_rolls + 1
        }
        
        while (players[[j]]$double_rolls > 0 & players[[j]]$double_rolls < 3) { # Player rolls again if they got doubles
          d1 = dice_1()
          d2 = dice_2()
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
          
          if (d1 == d2) { # Increment the player's number of consecutive doubles rolls
            players[[j]]$double_rolls = players[[j]]$double_rolls + 1
          }
        }
        
        if (players[[j]]$double_rolls == 3) { # If player rolls double 3 times in a row, then they go to jail
          players[[j]]$location <- 11
          jail = TRUE
        }
      }
    }  
  }    

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games_jail <- property_sum_10games_jail + properties
}  

names(property_sum_10games_jail) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

library(ggplot2)

prop_freq2 <- data.frame(
  property = factor(names(property_sum_10games_jail), levels = names(property_sum_10games_jail)),
  frequency = property_sum_10games_jail
)

ggplot(prop_freq2, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "pink") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies\nWith Jail and Doubles Conditions") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


## Section Four
```{r}
# Chance function
chance <- function() {
  card <- sample(1:16, 1)
  if (card == 1) {
    players[[j]]$location <- 40 # Advance to Boardwalk
  } else if (card == 2) {
    players[[j]]$location <- 1 # Advance to Go
  } else if (card == 3) {
    players[[j]]$location <- 25 # Advance to Illinois Ave
  } else if (card == 4) {
    players[[j]]$location <- 12 # Advance to St. Charles Place
  } else if (card == 5 || card == 6) { # Advance to the nearest railroad
    if (players[[j]]$location == 37) {
      players[[j]]$location <- 6 # Advance to Reading Railroad
    } else if (players[[j]]$location == 8) {
      players[[j]]$location <- 16 # Advance to Pennsylvania Railroad
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 26 # Advance to B&O Railroad
    } # Short Line doesn't apply here
  } else if (card == 7) { # Advance to the nearest utility
    if (players[[j]]$location == 8 || players[[j]]$location == 37) {
      players[[j]]$location <- 13 # Advance to Electric Company
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 29 # Advance to Water Works
    }
  } else if (card == 8) {
    players[[j]]$location <- players[[j]]$location - 3 # Move backwards 3 places
  } else if (card == 9) {
    players[[j]]$location <- 11 # Go to jail
    players[[j]]$jail == TRUE
  } else if (card == 10) {
    players[[j]]$location <- 6 # Advance to Reading Railroad
  } 
 }

# Simulation with the chance function and jail conditions
property_sum_10games_chance <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

for (game in 1:10) {
  game_board <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

  players <- list(
    player1 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player2 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player3 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0),
    player4 <- data.frame(
      location = 0,
      double_rolls = 0,
      jail = FALSE,
      jail_rolls = 0)
  )

  for (i in 1:50) {
    for (j in 1:4) {
      if (players[[j]]$jail == TRUE) {
        d1 = dice_1()
        d2 = dice_2()
        jail_rolls <- jail_rolls + 1
        
        if (d1 == d2 || players[[j]]$jail_rolls == 3) {
          jail = FALSE
          players[[j]]$jail_rolls <- 0
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        }
        
      } else {
        d1 = dice_1()
        d2 = dice_2()
        dice_total <- dice_1() + dice_2()
        players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
        if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
        game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        
        if (players[[j]]$location == 31) {
          players[[j]]$location <- 11
          jail = TRUE
        } else if (d1 == d2) {
          players[[j]]$double_rolls = players[[j]]$double_rolls + 1
        }
        
        while (players[[j]]$double_rolls > 0 & players[[j]]$double_rolls < 3) {
          d1 = dice_1()
          d2 = dice_2()
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
          
          if (d1 == d2) {
            players[[j]]$double_rolls = players[[j]]$double_rolls + 1
          }
        }
        
        if (players[[j]]$double_rolls == 3) {
          players[[j]]$location <- 11
          jail = TRUE
        }
      }
    }  
  }    

  properties <- game_board[c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)]
  
  property_sum_10games_chance <- property_sum_10games_chance + properties
}  

names(property_sum_10games_chance) <- c("Mediterranean Avenue", "Baltic Avenue", "Reading Railroad", "Oriental Avenue", "Vermont Avenue", "Connecticut Avenue", "St. Charles Place", "Electric Company", "States Avenue", "Virginia Avenue", "Pennsylvania Railroad", "St. James Place", "Tennessee Avenue", "New York Avenue", "Kentucky Avenue", "Indiana Avenue", "Illinois Avenue", "B&O Railroad", "Atlantic Avenue", "Ventnor Avenue", "Water Works", "Marvin Gardens", "Pacific Avenue", "North Carolina Avenue", "Pennsylvania Avenue", "Short Line", "Park Place", "Boardwalk")

# Plot
library(ggplot2)

prop_freq2 <- data.frame(
  property = factor(names(property_sum_10games_chance), levels = names(property_sum_10games_chance)),
  frequency = property_sum_10games_chance
)

ggplot(prop_freq2, aes(x = property, y = frequency)) +
  geom_bar(stat = "identity", fill = "maroon") +
  labs(x = "Index", y = "Frequency", title = "Bar Plot of Property Frequencies\nWith Jail and Doubles Conditions") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Section Five
```{r}
# Community Chest Cards Function
chest_positions <- c(3, 18, 34)
chest <- function() {
  chest_card <- sample(1:16, 1)
  if (players[[j]]$location %in% chest_positions) {
    if (chest_card == 1) {
      players[[j]]$location <- 1 # Advance to Go (Collect $200)
      players[[j]]$account <- players[[j]]$account + 200
    } else if (chest_card == 2) {
      players[[j]]$account <- players[[j]]$account + 200 # Bank error in your favor. Collect $200
    } else if (chest_card == 3) {
      players[[j]]$account <- players[[j]]$account - 50 # Doctor’s fee. Pay $50
      free_parking_fund <- free_parking_fund + 50
    } else if (chest_card == 4) {
      players[[j]]$account <- players[[j]]$money + 50 # From sale of stock you get $50
    } else if (chest_card == 5) {
      players[[j]]$get_out_of_jail_free == TRUE # Get Out of Jail Free
    } else if (chest_card == 6) {
      players[[j]]$jail == TRUE # Go to Jail. Go directly to jail, do not pass Go, do not collect $200
    } else if (chest_card == 7) {
      players[[j]]$account <- players[[j]]$account + 100 # Holiday fund matures. Receive $100
    } else if (chest_card == 8) {
      players[[j]]$account <- players[[j]]$account + 20 # Income tax refund. Collect $20
    } else if (chest_card == 9) {
      players[[j]]$account <- players[[j]]$account + 10 * 3 # It is your birthday. Collect $10 from every player
        for (k in 1:4) {
          if (k != j) {
            players[[k]]$account <- players[[k]]$account - 10
        }
      }
    } else if (chest_card == 10) {
      players[[j]]$account <- players[[j]]$account + 100 # Life insurance matures. Collect $100
    } else if (chest_card == 11) {
      players[[j]]$account <- players[[j]]$account - 100 # Pay hospital fees of $100
      free_parking_fund <- free_parking_fund + 100
    } else if (chest_card == 12) {
      players[[j]]$account <- players[[j]]$account - 50 # Pay school fees of $50
      free_parking_fund <- free_parking_fund + 50
    } else if (chest_card == 13) {
      players[[j]]$account <- players[[j]]$account - 25 # Receive $25 consultancy fee
      free_parking_fund <- free_parking_fund + 25
    } else if (chest_card == 14) {
      players[[j]]$account <- players[[j]]$account + 10 # You have won second prize in a beauty contest. Collect $10
    } else if (chest_card == 15) {
      players[[j]]$account <- players[[j]]$account + 100 # You inherit $100
    }
      # Card 16 is paying for houses and hotels -- doesn't apply here
  }
}

free_parking_fund <- 0

free_parking <- function(){
  if (players[[j]]$location == 20) {  # Free Parking position
  players[[j]]$account <- players[[j]]$account + free_parking_fund
  free_parking_fund <- 0  # Reset the fund
  }
}
```
### Chance function
```{r}
chance <- function() {
  card <- sample(1:16, 1)
  old_location <- players[[j]]$location
  new_location <- players[[j]]$location
   if (card == 1) {
    players[[j]]$location <- 40 # Advance to Boardwalk
    new_location <- players[[j]]$location
  } else if (card == 2) {
    players[[j]]$location <- 1 # Advance to Go
    new_location <- players[[j]]$location
  } else if (card == 3) {
    players[[j]]$location <- 25 # Advance to Illinois Ave
    new_location <- players[[j]]$location
  } else if (card == 4) {
    players[[j]]$location <- 12 # Advance to St. Charles Place
    new_location <- players[[j]]$location
  } else if (card == 5 || card == 6) { # Advance to the nearest railroad
    if (players[[j]]$location == 37) {
      players[[j]]$location <- 6 # Advance to Reading Railroad
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 8) {
      players[[j]]$location <- 16 # Advance to Pennsylvania Railroad
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 26 # Advance to B&O Railroad
      new_location <- players[[j]]$location
    } 
  } else if (card == 7) { # Advance to the nearest utility
    if (players[[j]]$location == 8 || players[[j]]$location == 37) {
      players[[j]]$location <- 13 # Advance to Electric Company
      new_location <- players[[j]]$location
    } else if (players[[j]]$location == 23) {
      players[[j]]$location <- 29 # Advance to Water Works
      new_location <- players[[j]]$location
    }
  } else if (card == 8) {
    players[[j]]$location <- players[[j]]$location - 3 # Move backwards 3 places
    new_location <- players[[j]]$location
  } else if (card == 9) {
    players[[j]]$location <- 11 # Go to jail
    players[[j]]$jail == TRUE
    new_location <- players[[j]]$location
  } else if (card == 10) {
    players[[j]]$location <- 6 # Advance to Reading Railroad
    new_location <- players[[j]]$location
  } 

  if (new_location < old_location && card %in% c(3,4,10)) {
    players[[j]]$account <- players[[j]]$account + 200 # Passing Go for cards 3, 4, and 10
  }
  
    else if (card == 11) {
      players[[j]]$account <- players[[j]]$account + 50 # Bank pays you $50
    }
    else if (card == 12) {
      players[[j]]$get_out_of_jail_free == TRUE # Get out of jail free card
    }
    else if (card == 13) {
      players[[j]]$account <- players[[j]]$account - 15 # Speeding fine $15
      free_parking_fund <- free_parking_fund + 15
    }
    else if (card == 14) {
      players[[j]]$account <- players[[j]]$account - 50 * 3
        for (k in 1:4) {
          if (k != j) {
            players[[k]]$account <- players[[k]]$account + 50 # Elected Chairman of the Board; pay each player $50
          }
        }
    }
    else if (card == 15) {
      players[[j]]$account <- players[[j]]$account + 150 # Building loan matures; collect $150
      
      # Card 16 is paying for houses and hotels -- doesn't apply here
    }
}
```

### Function determines ownership of a property when it is landed on
```{r}
ownership <- function(x) {
  for (p in players) {
    for (i in 1:7) {
      if (x == players[[p]]$owned_properties[i]) {
        if (p == players[[p]]$ID) {
          return(null)
        } else {
          return(players[[p]])
        }
      }
    }
  }
}
```

### Determines rent for railroads and utilities
```{r}
special_ownership <- function(x) {
  rail_count <- 0
  util_count
  for (i in 1:7) {
    if (x[i] == 6 || x[i] == 16 || x[i] == 26 || x[i] == 36) {
      rail_count <- rail_count + 1
    } else if (x[i] == 13 || x[i] == 29) {
      util_count = util_count + 1
    }
  }
  
  fees <- c()
  
  if (rail_count == 0) {
    fees <- append(fees, 0)
  } else if (rail_count == 1) {
    fees <- append(fees, 25)
  } else if (rail_count == 2) {
    fees <- append(fees, 50)
  } else {
    fees <- append(fees, 100)
  }
  
  if (util_count == 0) {
    fees <- append(fees, 0)
  } else if (util_count == 1) {
    fees <- append(fees, 4)
  } else {
    fees <- append(fees, 10)
  } 
  
  return(fees)
}
```

### Function to collect/pay rent and get money for passing go
```{r}
rent <- function(x) {
  if (x == 1) { # Go
    players[[j]]$account = players[[j]]$account + 200 
  } else if (x == 5) { # Income tax
    players[[j]]$account = players[[j]]$account - 200
  } else if (x == 39) { # Luxury tax
    players[[j]]$account = players[[j]]$account - 100
  }
  
  owner <- ownership(x)
  if (owner$in == TRUE) {
    if (x == 2) { # Mediterranean Ave
      players[[j]]$account = players[[j]]$account - 2
      owner$account = owner$account + 2
    } else if (x == 4) { # Baltic Ave
      players[[j]]$account = players[[j]]$account - 4
      owner$account = owner$account + 4
    } else if (x == 4 || x == 16 || x == 26 || x == 36) { # Railroads
      special_fees <- owner$rails_and_utils
      players[[j]]$account = players[[j]]$account - special_fees[1]
      owner$account = owner$account + special_fees[1]
    } else if (x == 6) { # Oriental Ave
      players[[j]]$account = players[[j]]$account - 6
      owner$account = owner$account + 6
    } else if (x == 9) { # Vermont Ave
      players[[j]]$account = players[[j]]$account - 6
      owner$account = owner$account + 6
    } else if (x == 10) { # Connecticut Ave
      players[[j]]$account = players[[j]]$account - 8
      owner$account = owner$account + 8
    } else if (x == 12) { # St. Charles Place
      players[[j]]$account = players[[j]]$account - 10
      owner$account = owner$account + 10
    } else if (x == 13 || x == 29) { # Utilities
      special_fees <- owner$rails_and_utils
      players[[j]]$account = players[[j]]$account - special_fees[2]
      owner$account = owner$account + special_fees[2]
    } else if (x == 14) { # States Ave
      players[[j]]$account = players[[j]]$account - 10
      owner$account = owner$account + 10
    } else if (x == 15) { # Virginia Ave
      players[[j]]$account = players[[j]]$account - 12
      owner$account = owner$account + 12
    } else if (x == 17) { # St. James Place
      players[[j]]$account = players[[j]]$account - 14
      owner$account = owner$account + 14
    } else if (x == 19) { # Tennessee Ave
      players[[j]]$account = players[[j]]$account - 14
      owner$account = owner$account + 14
    } else if (x == 20) { # New York Ave
      players[[j]]$account = players[[j]]$account - 16
      owner$account = owner$account + 16
    } else if (x == 22) { # Kentucky Ave
      players[[j]]$account = players[[j]]$account - 18
      owner$account = owner$account + 18
    } else if (x == 24) { # Indiana Ave
      players[[j]]$account = players[[j]]$account - 18
      owner$account = owner$account + 18
    } else if (x == 25) { # Illinois Ave
      players[[j]]$account = players[[j]]$account - 20
      owner$account = owner$account + 20
    } else if (x == 27) { # Atlantic Ave
      players[[j]]$account = players[[j]]$account - 22
      owner$account = owner$account + 22
    } else if (x == 28) { # Vetnor Ave
      players[[j]]$account = players[[j]]$account - 22
      owner$account = owner$account + 22
    } else if (x == 30) { # Marvin Gardens
      players[[j]]$account = players[[j]]$account - 24
      owner$account = owner$account + 24
    } else if (x == 32) { # Pacific Ave
      players[[j]]$account = players[[j]]$account - 26
      owner$account = owner$account + 26
    } else if (x == 33) { # North Carolina Ave
      players[[j]]$account = players[[j]]$account - 26
      owner$account = owner$account + 26
    } else if (x == 35) { # Pennsylvania Ave
      players[[j]]$account = players[[j]]$account - 28
      owner$account = owner$account + 28
    } else if (x == 38) { # Park Place
      players[[j]]$account = players[[j]]$account - 35
      owner$account = owner$account + 35
    } else if (x == 40) { # Boardwalk
      players[[j]]$account = players[[j]]$account - 50
      owner$account = owner$account + 50
    }
  }
}
```

### INCOMPLETE!!!!! Full simulation of a game
```{r}
properties <- c(2, 4, 6, 7, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 38, 40)

# Randomly give each player 7 properties
# Add location of properties to players owned properties vector
players <- list(
  player1 <- data.frame(
    ID = 1,
    location = 0,
    double_rolls = 0,
    jail = FALSE,
    jail_rolls = 0,
    account = 1500,
    owned_properties <- c(),
    rails_and_utils <- special_ownership(owned_preperties),
    get_out_of_jail_free = FALSE,
    in = TRUE),
  player2 <- data.frame(
    ID = 2,
    location = 0,
    double_rolls = 0,
    jail = FALSE,
    jail_rolls = 0,
    account = 1500,
    owned_properties <- c(),
    rails_and_utils <- special_ownership(owned_preperties),
    get_out_of_jail_free = FALSE,
    in = TRUE),
  player3 <- data.frame(
    ID = 3,
    location = 0,
    double_rolls = 0,
    jail = FALSE,
    jail_rolls = 0,
    account = 1500,
    owned_properties <- c(),
    rails_and_utils <- special_ownership(owned_preperties),
    get_out_of_jail_free = FALSE,
    in = TRUE),
  player4 <- data.frame(
    ID = 4,
    location = 0,
    double_rolls = 0,
    jail = FALSE,
    jail_rolls = 0,
    account = 1500,
    owned_properties <- c(),
    rails_and_utils <- special_ownership(owned_preperties),
    get_out_of_jail_free = FALSE,
    in = TRUE)
  )

# Make attribute to know how many players are still in
# Make attribute to count the number of turns taken

while (# at least 2 players are still in) {
  # Add rent function to this whole thing
  for (j in 1:4) {
    if (players[[j]]$in != FALSE) {
      if (players[[j]]$jail == TRUE) {
        d1 = dice_1()
        d2 = dice_2()
        jail_rolls <- jail_rolls + 1
        
        if (d1 == d2 || players[[j]]$jail_rolls == 3) {
          jail = FALSE
          players[[j]]$jail_rolls <- 0
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          # Add community chest
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        }
        
      } else {
        d1 = dice_1()
        d2 = dice_2()
        dice_total <- dice_1() + dice_2()
        players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
        if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
        }
        # Add community chest
        game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
        
        if (players[[j]]$location == 31) {
          players[[j]]$location <- 11
          jail = TRUE
        } else if (d1 == d2) {
          players[[j]]$double_rolls = players[[j]]$double_rolls + 1
        }
        
        while (players[[j]]$double_rolls > 0 & players[[j]]$double_rolls < 3) {
          d1 = dice_1()
          d2 = dice_2()
          dice_total <- dice_1() + dice_2()
          players[[j]]$location <- (players[[j]]$location + dice_total) %% 41
          if (players[[j]]$location == 8 || players[[j]]$location == 23 || players[[j]]$location == 37) {
            game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
            chance()
          }
          # Add community chest
          game_board[players[[j]]$location] <- game_board[players[[j]]$location] + 1
          
          if (d1 == d2) {
            players[[j]]$double_rolls = players[[j]]$double_rolls + 1
          }
        }
        
        if (players[[j]]$double_rolls == 3) {
          players[[j]]$location <- 11
          jail = TRUE
        }
      }
      # Increment number of turns attribute
      # If any players account is negative then they are out
    }  
  }
}
```
